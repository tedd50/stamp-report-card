<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WELLBEING ACADEMY REPORT CARD</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f5f5f5;
        }

        #report-card {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: auto;
            aspect-ratio: 1409 / 2000;
            background-image: url('Background.png');
            background-size: cover;
            background-position: center;
        }

        #name,
        #year,
        #quarter {
            position: absolute;
            font-size: 0.8rem;
            font-weight: bold;
            color: #333;
        }

        #name {
            top: 15.5%;
            left: 50%;
            transform: translateX(-50%);
            text-align: left;
        }

        #year {
            top: 95%;
            left: 20%;
            transform: translateX(-50%);
            text-align: center;
        }

        #quarter {
            top: 95%;
            left: 76.5%;
            transform: translateX(-50%);
            text-align: center;
        }

        .stamp-box {
            position: absolute;
            width: 60px;
            height: 60px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
    </style>
</head>

<body>
    <div id="report-card">
        <div id="name">Novita Liesera</div>
        <div id="year">2025</div>
        <div id="quarter">1</div>
    </div>

    <script>
        const API_URL = 'https://loyalty-stamp.onrender.com/stamps/1';
        const ASSETS = {
            stamped: './StampedBox.png',
            empty: './EmptyBox.png'
        };

        async function fetchReportData() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();

                // Populate student info
                document.getElementById('name').textContent = `${data.name}`;
                document.getElementById('year').textContent = `${data.period.year}`;
                document.getElementById('quarter').textContent = `${data.period.quarter}`;

                // Populate stamp boxes
                const container = document.getElementById('report-card');
                const ROW_OFFSET = 142; // Top padding from the report card
                const COL_OFFSET = 12;  // Left padding from the report card
                const BOX_SIZE = 63;    // Size of each box (includes spacing within the row)
                const ROW_SPACING = 15; // Extra space between rows

                data.stamps.forEach((stamp, index) => {
                    const stampBox = document.createElement('div');
                    stampBox.classList.add('stamp-box');
                    stampBox.style.backgroundImage = `url(${stamp ? ASSETS.stamped : ASSETS.empty})`;

                    const row = Math.floor(index / 6); // 6 boxes per row
                    const col = index % 6;

                    // Determine the row spacing dynamically
                    const additionalRowSpacing = (row < 4 || row > 4) ? ROW_SPACING : ROW_SPACING - 4;

                    // Calculate the position with conditional spacing
                    stampBox.style.top = `${ROW_OFFSET + row * BOX_SIZE + row * additionalRowSpacing}px`;
                    stampBox.style.left = `${COL_OFFSET + col * BOX_SIZE}px`;

                    container.appendChild(stampBox);
                });
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        fetchReportData();
    </script>
</body>

</html>